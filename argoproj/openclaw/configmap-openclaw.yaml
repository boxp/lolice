apiVersion: v1
kind: ConfigMap
metadata:
  name: openclaw-config
  namespace: openclaw
data:
  openclaw.json: |
    {
      "models": {
        "providers": {
          "litellm": {
            "baseUrl": "http://litellm.openclaw.svc.cluster.local:4000",
            "apiKey": "${LITELLM_PROXY_KEY}",
            "api": "openai-completions",
            "models": [
              {
                "id": "anthropic/claude-sonnet-4-5-20250929",
                "name": "Claude Sonnet 4.5",
                "reasoning": true,
                "input": ["text", "image"],
                "contextWindow": 200000,
                "maxTokens": 16384
              },
              {
                "id": "anthropic/claude-opus-4-6",
                "name": "Claude Opus 4.6",
                "reasoning": true,
                "input": ["text", "image"],
                "contextWindow": 200000,
                "maxTokens": 32000
              },
              {
                "id": "zai/glm-4.7",
                "name": "GLM-4.7",
                "reasoning": true,
                "input": ["text"],
                "contextWindow": 200000,
                "maxTokens": 4096
              },
              {
                "id": "zai/glm-4.5-flash",
                "name": "GLM-4.5 Flash",
                "reasoning": false,
                "input": ["text"],
                "contextWindow": 128000,
                "maxTokens": 4096
              },
              {
                "id": "google/gemini-2.5-flash",
                "name": "Gemini 2.5 Flash",
                "reasoning": true,
                "input": ["text", "image"],
                "contextWindow": 1048576,
                "maxTokens": 65536
              },
              {
                "id": "google/gemini-2.5-pro",
                "name": "Gemini 2.5 Pro",
                "reasoning": true,
                "input": ["text", "image"],
                "contextWindow": 1048576,
                "maxTokens": 65536
              },
              {
                "id": "openai/gpt-5-mini",
                "name": "GPT-5 mini",
                "reasoning": true,
                "input": ["text", "image"],
                "contextWindow": 400000,
                "maxTokens": 128000
              },
              {
                "id": "openai/gpt-5.1-codex-mini",
                "name": "GPT-5.1 Codex mini",
                "reasoning": true,
                "input": ["text"],
                "contextWindow": 400000,
                "maxTokens": 128000
              }
            ]
          }
        }
      },
      "tools": {
        "exec": {
          "security": "allowlist",
          "ask": "on-miss",
          "safeBins": [
            "gh", "ghq", "gwq",
            "ls", "cat", "grep",
            "head", "tail", "wc", "jq",
            "uniq", "cut", "tr",
            "pwd", "date", "stat",
            "dirname", "basename"
          ],
          "pathPrepend": ["/opt/gh-wrapper"]
        }
      },
      "agents": {
        "defaults": {
          "model": {
            "primary": "openai-codex/gpt-5.3-codex",
            "fallbacks": ["litellm/google/gemini-2.5-flash", "openai-codex/gpt-4o-mini", "openai-codex/o4-mini"]
          },
          "models": {
            "litellm/anthropic/claude-sonnet-4-5-20250929": {
              "alias": "sonnet"
            },
            "litellm/anthropic/claude-opus-4-6": {
              "alias": "opus"
            },
            "litellm/zai/glm-4.7": {
              "alias": "glm47"
            },
            "litellm/zai/glm-4.5-flash": {
              "alias": "glm4-flash"
            },
            "litellm/google/gemini-2.5-flash": {
              "alias": "flash"
            },
            "litellm/google/gemini-2.5-pro": {
              "alias": "gemini-pro"
            },
            "openai-codex/gpt-4o-mini": {
              "alias": "gpt4o-mini"
            },
            "openai-codex/o4-mini": {
              "alias": "o4-mini"
            },
            "openai-codex/gpt-5.3-codex": {
              "alias": "codex"
            },
            "litellm/openai/gpt-5-mini": {
              "alias": "gpt5-mini"
            },
            "litellm/openai/gpt-5.1-codex-mini": {
              "alias": "codex-mini"
            }
          },
          "heartbeat": {
            "every": "30m",
            "target": "discord"
          },
          "sandbox": {
            "mode": "off"
          }
        }
      },
      "plugins": {
        "entries": {
          "discord": {
            "enabled": true
          },
          "telegram": {
            "enabled": true
          }
        }
      },
      "channels": {
        "discord": {
          "enabled": true,
          "token": "${DISCORD_BOT_TOKEN}",
          "dm": {
            "enabled": true,
            "policy": "allowlist",
            "allowFrom": ["346180680851652618"]
          },
          "execApprovals": {
            "enabled": true,
            "approvers": ["346180680851652618"],
            "target": "dm",
            "cleanupAfterResolve": true
          }
        },
        "telegram": {
          "enabled": true,
          "botToken": "${TELEGRAM_BOT_TOKEN}",
          "dmPolicy": "pairing"
        }
      },
      "diagnostics": {
        "enabled": true,
        "otel": {
          "enabled": true,
          "endpoint": "http://prometheus-k8s.monitoring.svc:9090/api/v1/otlp",
          "protocol": "http/protobuf",
          "serviceName": "openclaw",
          "traces": false,
          "metrics": true,
          "logs": false,
          "flushIntervalMs": 30000
        }
      },
      "gateway": {
        "mode": "local",
        "bind": "lan",
        "port": 18789,
        "auth": {
          "token": "${OPENCLAW_GATEWAY_TOKEN}"
        },
        "controlUi": {
          "allowInsecureAuth": true
        }
      }
    }
