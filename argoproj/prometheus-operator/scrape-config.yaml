apiVersion: monitoring.coreos.com/v1alpha1
kind: ScrapeConfig
metadata:
  name: static-config
  namespace: monitoring
  labels:
    prometheus: system-monitoring-prometheus
spec:
  staticConfigs:
    - job_name: "cloudflared"
      kubernetes_sd_configs:
        - role: pod
      relabel_configs:
        - source_labels: [__meta_kubernetes_pod_label_app]
          regex: "cloudflared"
          action: keep
    - labels:
        job: stage-hitohub-cloudflared
      targets:
        -  hitohub-cloudflared-metrics.stage-hitohub.svc.cluster.local:2000
    - labels:
        job: prod-hitohub-cloudflared
      targets:
        -  hitohub-cloudflared-metrics.prod-hitohub.svc.cluster.local:2000
